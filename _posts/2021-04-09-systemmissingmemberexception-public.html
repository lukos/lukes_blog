---
layout: post
title: 'System.MissingMemberException: Public member ''GetSecretAsync'' on type ''KeyVaultClient''
  not found'
date: '2021-04-09T05:31:00.000-07:00'
author: Luke Briner
tags:
modified_time: '2021-04-09T05:31:20.132-07:00'
---

<p>This could also happen for any "Public member on type not found" combinations.</p><p>This can happen any time you have a late-bound method call in VB .Net that does not exist in the object. In my case, the short answer is that you cannot late-bind extension methods!</p><p>In VB .Net, if you specify concrete types for your variables and/or function return types, then the compiler can early-bind the calls and work out exactly what is pointing to what. If you have mistyped, Visual Studio can show you where you've gone wrong. If the compiler doesn't know what the type is, it cannot determine if the method even exists until runtime, at which point it might fall over with a MissingMemberException.</p><p><span style="font-family: courier;">Dim earlyBound As String = MyFunction()</span></p><p><span style="font-family: courier;">earlyBound.BadMethod()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Compiler error, String does not contain the member BadMethod</span></p><p><span style="font-family: courier;">Public MyFunction() As String</span></p><p><span style="font-family: courier;">&nbsp;&nbsp; Return "something" <br /></span></p><p><span style="font-family: courier;">End Function<br /></span></p><p><span style="font-family: courier;">&nbsp;</span></p><p><span style="font-family: courier;">' Late bound example<br /></span></p><p><span style="font-family: courier;">Dim myVariable = MyFunction()</span></p><p><span style="font-family: courier;">myVariable.DoSomething()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Late-bound, the compiler doesn't know what type myVariable is</span></p><p><span style="font-family: courier;">Public Function MyFunction()</span></p><p><span style="font-family: courier;">&nbsp;&nbsp; Return "something" <br /></span></p><p><span style="font-family: courier;">End Function</span></p><p>So what about extension methods?&nbsp;</p><p>An extension method is a static method in a static class that the compiler interprets on your behalf. An extension method always has a first "this" parameter of the target type and the compiler effectively converts this:</p><p>myString.ExtensionMethod()</p><p>into this</p><p>ExtensionClass.ExtensionMethod(myString)</p><p>That is all fine except for one important detail. The extension methods must reside in a different class to the class they are targetting because they must be in a static class.</p><p>Why is this an issue? Image we have a StringExtensions class and one method called TruncateLongString(string As String, length As Integer) and imagine we have the following late-bound code:</p><p><span style="font-family: courier;">Dim myVariable = MyFunction()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' MyFunction returns a string but the compiler does not know this</span></p><p><span style="font-family: courier;">myVariable.TruncateLongString(50)&nbsp;&nbsp;&nbsp; ' Compiler will allow this and will make a late-bind attempt</span></p><p>At runtime, when the code is actually executed, what actually happens under the covers would be something like this:</p><p><span style="font-family: courier;">Dim myVariable = MyFunction()</span></p><p><span style="font-family: courier;">myStringVariable = CType(myVariable, String)&nbsp; ' Since I now know it is a String</span></p><p><span style="font-family: courier;">myStringVariable.TruncateLongString(50) ' MissingMemberException: String does not contain TruncateLongString(), which is correct, it doesn't!</span></p><p>So how do we avoid this? Use types for your Functions and ideally your variables.<br /></p><p><br /></p>